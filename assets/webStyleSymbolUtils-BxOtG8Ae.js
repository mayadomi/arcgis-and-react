import{s as N,Q as D,I as p,u as d,R as U,x as I,c as h,i as S}from"./index-BdlI2FVT.js";import{c as v,a as w}from"./devEnvironmentUtils-Blrp8lZ5.js";import{c as A,b as P,p as j,a as O,w as E,d as M}from"./styleUtils-DHuQZmH8.js";import"./layerUtils-C0ByrsCg.js";function B(t,e,l,n){const r=t.name;return r==null?Promise.reject(new N("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName&&t.styleName==="Esri2DPointSymbolsStyle"?W(r,e,n):A(t,e,n).then(o=>T(o,r,e,l,M,n))}function Q(t,e){return e.items.find(l=>l.name===t)}function T(t,e,l,n,r,o){var c,g;const s=(l==null?void 0:l.portal)!=null?l.portal:D.getDefault(),b={portal:s,url:p(t.baseUrl),origin:"portal-item"},m=Q(e,t.data);if(!m){const y=`The symbol name '${e}' could not be found`;return Promise.reject(new N("symbolstyleutils:symbol-name-not-found",y,{symbolName:e}))}let i=d(r(m,n),b),u=((c=m.thumbnail)==null?void 0:c.href)??null;const f=(g=m.thumbnail)==null?void 0:g.imageData;v()&&(i=w(i)??"",u=w(u));const R={portal:s,url:p(U(i)),origin:"portal-item"};return P(i,o).then(y=>{const x=n==="cimRef"?j(y.data):y.data,a=O(x,R);if(a&&I(a)){if(u){const F=d(u,b);a.thumbnail=new h({url:F})}else f&&(a.thumbnail=new h({url:`data:image/png;base64,${f}`}));t.styleUrl?a.styleOrigin=new S({portal:l.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(a.styleOrigin=new S({portal:l.portal,styleName:t.styleName,name:e}))}return a})}function W(t,e,l){const n=E.replaceAll(/\{SymbolName\}/gi,t),r=e.portal!=null?e.portal:D.getDefault();return P(n,l).then(o=>{const s=j(o.data);return O(s,{portal:r,url:p(U(n)),origin:"portal-item"})})}export{T as fetchSymbolFromStyle,Q as getStyleItemFromStyle,B as resolveWebStyleSymbol};

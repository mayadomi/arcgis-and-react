import{V as h,k as u,p as c,h as y,b as f,n as g,f as w,g as V}from"./index-BdlI2FVT.js";import{m as v,u as C}from"./LayerView-D4u4EJ0S.js";import"./scaleUtils-DaNVMeZM.js";import"./Container-2mGzxoHB.js";import"./map-CoC24dow.js";import"./Basemap-CgzecouK.js";import"./loadAll-d4sPuW9e.js";import"./PortalItem-D_imZ4F9.js";import"./writeUtils-BJozxT0a.js";import"./layerUtils-C0ByrsCg.js";import"./compilerUtils-vO2blZnn.js";import"./CollectionFlattener-CM1KduCr.js";import"./mat4f32-DcsiF_Rp.js";import"./mat4-CSxAPr-6.js";import"./TablesMixin-osra4OQn.js";import"./Layer-CcYrbAYa.js";import"./Cyclical-DUB0vV49.js";import"./workers-BoWLbb4j.js";import"./projection-NmY8Pkrx.js";import"./TileInfo-dXrVrRwv.js";import"./themeUtils-B9K1g8Wn.js";import"./uuid-fwrPAdZb.js";import"./UpdatingHandles-DjmbdLdJ.js";import"./signal-yOcmJBqC.js";import"./commonProperties-DDhb4E0s.js";import"./GraphicsCollection-BMGOUijs.js";import"./HeightModelInfo-B2Y4TPgv.js";import"./QueueProcessor-tmTJ5qZx.js";import"./Query-C67dhdyp.js";import"./Field-CcwrtZjp.js";import"./fieldType-CHp3lv4g.js";import"./portalItemUtils-CCKlXC6h.js";import"./ViewingMode-HRfKv6NR.js";import"./unitBezier-BX6NeAEr.js";import"./HighlightOptions-UfuqKf1Y.js";import"./TileKey-D5-VD3yk.js";import"./vec2-DEIrm0UN.js";import"./quickselect-D0_cvEX6.js";import"./_commonjsHelpers-DCkdB7M8.js";import"./vec2f64-CaE_5U6X.js";import"./normalizeUtils-Cik6ve5l.js";import"./normalizeUtilsCommon-Cpq7p5az.js";import"./utils-nisnNviQ.js";import"./mat3-e0AQhzgy.js";import"./vec2f32-BbH2jxlN.js";import"./capabilities-C84AMSCg.js";import"./FeatureLayer-jETWI0X3.js";import"./UniqueValueRenderer-7uqoe5qH.js";import"./ColorStop-BjodVbhP.js";import"./diffUtils-Cvmld_nE.js";import"./colorRamps-CSdC0saB.js";import"./styleUtils-DHuQZmH8.js";import"./jsonUtils-BIPVkO8e.js";import"./LRUCache-CZ2xYNgP.js";import"./Version-Cllr3DhQ.js";import"./FieldsIndex-BZm6eFTZ.js";import"./UnknownTimeZone-BLIgHyqR.js";import"./colorUtils-K6WWckc_.js";import"./vec42-DpHkGCNS.js";import"./vec4f64-CCf6w8sj.js";import"./heatmapUtils-Xd5ASPFI.js";import"./MultiOriginJSONSupport-BP0y40tB.js";import"./FormTemplate-Fi3tdScn.js";import"./editsZScale-Csrkyd4Q.js";import"./queryZScale-DxngEzoS.js";import"./FeatureSet-BVXviJDD.js";import"./APIKeyMixin-Cr6SPtKV.js";import"./ArcGISService-B0MFY8rl.js";import"./BlendLayer-CCBI54kf.js";import"./CustomParametersMixin-B15dM9ne.js";import"./EditBusLayer-BMIf9G9a.js";import"./FeatureEffectLayer-BThrs5AW.js";import"./FeatureLayerBase-DLhTJN_m.js";import"./featureLayerUtils-ecDuVTtZ.js";import"./AttachmentQuery-CmVGfcPE.js";import"./RelationshipQuery-BllPoPyE.js";import"./LayerFloorInfo-CAYEpzeH.js";import"./serviceCapabilitiesUtils-CcOSoojL.js";import"./FeatureReductionLayer-hLfjwizl.js";import"./FeatureReductionSelection-B0n0R-D3.js";import"./LabelClass-1tjVzjjL.js";import"./defaults-xH7YtUqE.js";import"./defaultsJSON-CHAaurhX.js";import"./MD5-C9MwAd2G.js";import"./OperationalLayer-BvVMmVx0.js";import"./OrderedLayer-DupPBghv.js";import"./PortalLayer-Ce7CgRR0.js";import"./RefreshableLayer-DgZkcGPN.js";import"./ScaleRangeLayer-B24df4gL.js";import"./TemporalLayer-BLPwEJby.js";import"./TimeInfo-BBnCNS7R.js";import"./FeatureTemplate-BXMIhaq_.js";import"./FeatureType-CW1OCJu1.js";import"./fieldProperties-BRDCz7QD.js";import"./labelingInfo-Dio46WYR.js";import"./versionUtils-DcsImNVm.js";import"./styleUtils-CiyELj_N.js";import"./TopFeaturesQuery-o_i6H2-K.js";import"./popupUtils-fsRna_vH.js";import"./interfaces-CL2NbQte.js";import"./highlightReasons-DJwsG8nn.js";import"./definitions-C14Q9bsB.js";import"./enums-CYMvjYBC.js";import"./Texture-p7xZY2dS.js";const m=Symbol();let d=class extends v(C){constructor(){super(...arguments),this.layerViews=new h,this._debouncedUpdate=u(async()=>{const{layer:t,parent:{footprintLayerView:r}}=this;let p=[];if(r){const a=this._createQuery(),{features:s}=await r.queryFeatures(a);this.suspended||(p=s.map(e=>t.acquireLayer(e)))}this.removeHandles(m),this.addHandles(p,m)})}attach(){this.addAttachHandles([this._updatingHandles.addOnCollectionChange(()=>this.layerViews,()=>this._updateStageChildren(),{initial:!0}),c(()=>{var t;return((t=this.parent.footprintLayerView)==null?void 0:t.dataUpdating)===!1},()=>this._updateLayers()),y(()=>{var t;return[this.layer.maximumVisibleSublayers,this.suspended,(t=this.parent.footprintLayerView)==null?void 0:t.filter]},()=>this._updateLayers())])}detach(){this.container.removeAllChildren(),this.removeHandles(m)}update(t){}moveStart(){}viewChange(){}moveEnd(){}isUpdating(){return this.layerViews.some(t=>t.updating)}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach((t,r)=>this.container.addChildAt(t.container,r))}_updateLayers(){this.suspended?this.removeHandles(m):this._updatingHandles.addPromise(this._debouncedUpdate().catch(t=>{f.getLogger(this).error(t)}))}_createQuery(){const{parent:{footprintLayerView:t},layer:{maximumVisibleSublayers:r,parent:{itemTypeField:p,itemSourceField:a,objectIdField:s,orderBy:e}}}=this,l=`${p} <> 'Scene Service'`,i=t.createQuery();i.returnGeometry=!1,i.num=r,i.outFields=[s,a],i.where=g(i.where,l);const o=e==null?void 0:e.find(n=>n.field&&!n.valueExpression);return o!=null&&o.field&&(i.orderByFields=[`${o.field} ${o.order==="descending"?"DESC":"ASC"}`]),i}};d=w([V("esri.views.2d.layers.CatalogDynamicGroupLayerView2D")],d);const wi=d;export{wi as default};
